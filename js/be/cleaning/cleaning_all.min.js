function callRoomsDrawSchema(e){console.log(e);let c=document.querySelector("#room_card"),t=document.querySelector("#room_view_container"),s=t.querySelector("#room_view_container_shared"),i=t.querySelector("#room_view_container_privates");if(0==Object.entries(e).length)return console.log("no rooms"),document.getElementById("no_rooms_msg").hidden=0,void(t.hidden=1);Array.from(Object.values(e)).forEach(function(e){var t,r=e[0],o=e[1],a=e[2],n=(e[3],e[4]),e=e[5];let l=c.content.cloneNode(!0);if(l.querySelector(".room-name").textContent=a,l.querySelector(".room-card-container").id="rid_"+r,1==(l.querySelector(".room-type").textContent=o)){l.querySelector(".room-card-center").href="#_",l.querySelector(".room-card-center").classList.add("dorm","w100"),l.querySelector(".room-clean-buttons").classList.add("hidden");for(let e=1;e<=n;e++)t=(t="<li class='show-all-bookings-li' id='r"+r+"_b"+e+"' data-rid="+r+" data-bed="+e+">")+"  \t<h3 class='bed-number'>"+e+"</h3>  \t<div class='grid-container gap2p mobile-keep checkout-info'>\t\t\t\t\t</div>\t\t<div class='flex-container'>\t\t\t<a class='bed-clean-button begin disabled' onclick='finishCleaningDorm(this)'>Done</a>\t\t</div></li>",t=parseHTML(t),l.querySelector(".show-all-bookings ul").appendChild(t)}a="/assets/be/icons/"+roomsCatImg(e);l.querySelector(".img-room-cat").src=a,(0==o?i:s).appendChild(l)});let r;0==i.childNodes.length&&(r=getParentByClass(i,"rooms-card-container")).classList.add("hidden"),0==s.childNodes.length&&(r=getParentByClass(s,"rooms-card-container")).classList.add("hidden"),retrieveBookings()}function callRoomsRetrieveBookings(e){console.log(e);let a,n,t,l,r,c,s,i,d,m;let o=new Intl.DateTimeFormat("en",{year:"numeric",month:"2-digit",day:"2-digit"}),u=new Date;var y=u.getHours();let g=u.getTime();var[{value:f},,{value:h},,{value:S}]=o.formatToParts(u);cleanA={},console.log("hour now: "+y+"; timeNow: "+g+"; today: "+(S+"-"+f+"-"+h)+";"),e.hasOwnProperty("live")&&e.live.hasOwnProperty("cleaning")&&(cleanA=e.live.cleaning),console.log(cleanA),Array.from(Object.values(e)).forEach(function(o){if(!o.hasOwnProperty("cleaning")&&(r=o[1],a=o[3],n=o[4],c=o[5],t=o[6],l=o[7],s=o[8],100!=r&&0!=n)){o=Math.floor((milliSecondsFromString(l)-g)/1e3/3600/24)+1;Math.floor((milliSecondsFromString(t)-g)/1e3/3600/24),i=document.querySelector("#rid_"+a),d=i.firstElementChild,m=d.querySelector(".room-type").innerText,new Intl.DateTimeFormat("en",{month:"short",day:"2-digit"});let r="cst";if(0==m){if(!i.classList.contains("already-cycled")){i.classList.add("already-cycled");let e="";0==o?r=9==s?(e="Left Today","cst-9"):(e="Will Leave Today","cst-8"):1==o&&(e="Will leave tomorrow",r="cst-tomorrow"),d.querySelector(".checkout-info").innerText=e,d.querySelector(".checkout-info").classList.add(r),d.querySelector(".room-card-left").classList.add(r)}}else{let e=i.querySelector("#r"+a+"_b"+n),t="";0==o?r=9==s?(t="Left Today","cst-9"):(t="Will Leave Today","cst-8"):1==o&&(t="Will leave tomorrow",r="cst-tomorrow"),e.querySelector(".checkout-info").innerText=t,e.querySelector(".checkout-info").classList.add(r)}}}),writeCleanInfos(cleanA,{})}function writeCleanInfos(e,a){e.forEach(function(e){console.log(e);var t=e[0],r=e[1],o=e[2];if(target=document.querySelector("#rid_"+t),card=target.firstElementChild,rtype=card.querySelector(".room-type").innerText,card.dataset.clid=e[6],card.dataset.rid=t,0==rtype)0==o?(card.querySelector(".room-card-left").classList.add("cl-0"),card.querySelector(".room-clean-button.begin").classList.remove("disabled"),card.querySelector(".room-clean-button.finish").classList.remove("disabled"),card.querySelector(".toclean-info").classList.remove("hidden"),null!=e[3]&&(card.querySelector(".toclean-info-time").innerText=stringFromSeconds(e[3]))):1==o?(card.querySelector(".room-card-left").classList.add("cl-1"),card.querySelector(".room-clean-button.finish").classList.add("cleaning"),card.querySelector(".room-clean-button.finish").classList.remove("disabled"),card.querySelector(".cleaning-info").classList.remove("hidden"),null!=e[4]&&(card.querySelector(".cleaning-info-time").innerText=stringFromSeconds(e[4]))):5==o&&(card.querySelector(".cleaned-info").classList.remove("hidden"),null!=e[5]&&(card.querySelector(".cleaned-info-time").innerText=stringFromSeconds(e[5])),null!=e[5]&&(card.querySelector(".cleaned-info-user").innerText=e[8]));else{let e=target.querySelector("#r"+t+"_b"+r);0==o?(e.querySelector(".bed-clean-button.begin").classList.remove("disabled"),void 0!==a[t]?a[t]=a[t]+1:a[t]=1):1==o&&(e.querySelector(".bed-clean-button.begin").classList.add("hidden","disabled"),e.querySelector(".bed-clean-button.finish").classList.remove("hidden","disabled"))}}),console.log(a),Array.from(Object.keys(a)).forEach(function(e){console.log(e);var t=a[e];let r="";r=1==t?"There is <span class='cleanBedsNumbers tcoral'>1</span> bed to clean":0==t?"There are no beds to clean":"There are <span class='cleanBedsNumbers tcoral'>"+t+"</span> beds to clean",(target=document.querySelector("#rid_"+e)).querySelector(".room-card-center .checkout-info").innerHTML=r,target.querySelector(".room-card-left").classList.add("cl-0")})}function drawSchema(){roomsDrawSchema()}function roomsDrawSchema(){let e;for(e=document.getElementById("room_view_container_privates");e.firstChild;)e.removeChild(e.firstChild);for(e=document.getElementById("room_view_container_shared");e.firstChild;)e.removeChild(e.firstChild);postHttpReq("rooms_schema_get")}function retrieveBookings(e){new Date;let t=new Date,r=new Date;r.setTime(t.getTime()-864e5),e=t.getFullYear()+"-"+String(parseInt(t.getMonth())+1).padStart(2,"0")+"-"+String(parseInt(t.getDate())).padStart(2,"0"),centerDateLess=r.getFullYear()+"-"+String(parseInt(r.getMonth())+1).padStart(2,"0")+"-"+String(parseInt(r.getDate())).padStart(2,"0"),arr="&d="+centerDateLess+","+e,postHttpReq("rooms_retrieve_bookings",arr)}function roomsShowAllBookings(e){let t=getParentByClass(e,"room-card-container");e=t.id.split("_")[1];if(0==t.querySelector(".room-type").innerText)return!1;t.querySelector(".show-all-bookings").classList.toggle("hidden"),console.log(e)}function beginCleaningPrivate(r){if(!r.classList.contains("disabled")){let e=getParentByClass(r,"room-card");var o=e.dataset.rid;r.classList.add("disabled"),r.parentElement.querySelector("a.finish").classList.add("cleaning"),e.querySelector(".room-card-left").classList.remove("cl-0"),e.querySelector(".room-card-left").classList.add("cl-1"),e.querySelector(".room-card-center .toclean-info").classList.add("hidden"),e.querySelector(".room-card-center .cleaning-info").classList.remove("hidden"),e.querySelector(".room-card-center .cleaning-info-time").innerText="0 minutes";let t=new FormData;t.append("state",1),t.append("rid",o),t.append("rtype",0),t.append("q","rooms_cln_update_private"),postFetch(t)}}function finishCleaningPrivate(r){if(!r.classList.contains("disabled")){let e=getParentByClass(r,"room-card");var o=e.dataset.rid;r.classList.add("disabled"),r.classList.remove("cleaning"),r.parentElement.querySelector("a.begin").classList.add("disabled"),e.querySelector(".room-card-left").classList.remove("cl-1","cl-0"),e.querySelector(".room-card-center .toclean-info").classList.add("hidden"),e.querySelector(".room-card-center .cleaning-info").classList.add("hidden"),e.querySelector(".room-card-center .cleaned-info").classList.remove("hidden"),e.querySelector(".room-card-center .cleaned-info-time").innerText="0 minutes";let t=new FormData;t.append("state",5),t.append("rid",o),t.append("rtype",0),t.append("q","rooms_cln_update_private"),postFetch(t)}}function finishCleaningDorm(t){if(!t.classList.contains("disabled")){var r=getParentByClass(t,"show-all-bookings-li"),o=r.dataset.rid,r=r.dataset.bed;t.classList.add("disabled");let e=new FormData;e.append("state",5),e.append("rid",o),e.append("bed",r),e.append("rtype",1),e.append("q","rooms_cln_update_dorm"),postFetch(e)}}
