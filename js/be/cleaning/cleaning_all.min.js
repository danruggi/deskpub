function callRoomsDrawSchema(e){let t=document.querySelector("#room_card"),r=document.querySelector("#room_view_container"),o=r.querySelector("#room_view_container_shared"),n=r.querySelector("#room_view_container_privates");if(0==Object.entries(e).length){console.log("no rooms"),document.getElementById("no_rooms_msg").hidden=0,r.hidden=1;return}Array.from(Object.values(e)).forEach(function(e){let r=e[0],l=e[1],a=e[2];e[3];let i=e[4],c=e[5],s=t.content.cloneNode(!0);if(s.querySelector(".room-name").textContent=a,s.querySelector(".room-card-container").id="rid_"+r,s.querySelector(".room-type").textContent=l,1==l){s.querySelector(".room-card-center").href="#_",s.querySelector(".room-card-center").classList.add("dorm","w100"),s.querySelector(".room-clean-buttons").classList.add("hidden");let d;for(let u=1;u<=i;u++)d="<li class='show-all-bookings-li' id='r"+r+"_b"+u+"' data-rid="+r+" data-bed="+u+">",d+="  	<h3 class='bed-number'>"+u+"</h3>",d+="  	<div class='grid-container gap2p mobile-keep checkout-info'>",d+="			",d+="		</div>",d+="		<div class='flex-container'>",d+="			<a class='bed-clean-button begin disabled' onclick='finishCleaningDorm(this)'>Done</a>",d+="		</div>",d+="</li>",d=parseHTML(d),s.querySelector(".show-all-bookings ul").appendChild(d)}let m=roomsCatImg(c);s.querySelector(".img-room-cat").src="/assets/be/icons/"+m,0==l?n.appendChild(s):o.appendChild(s)});let l;0==n.childNodes.length&&(l=getParentByClass(n,"rooms-card-container")).classList.add("hidden"),0==o.childNodes.length&&(l=getParentByClass(o,"rooms-card-container")).classList.add("hidden"),retrieveBookings()}function callRoomsRetrieveBookings(e){console.log(e);let t,r,o,n,l,a,i,c,s,d,u=new Intl.DateTimeFormat("en",{year:"numeric",month:"2-digit",day:"2-digit"}),m=new Date,f=m.getHours(),y=m.getTime(),[{value:h},,{value:S},,{value:p}]=u.formatToParts(m);cleanA={},console.log("hour now: "+f+"; timeNow: "+y+"; today: "+(p+"-"+h)+"-"+S+";"),e.hasOwnProperty("live")&&e.live.hasOwnProperty("cleaning")&&(cleanA=e.live.cleaning),console.log(cleanA),Array.from(Object.values(e)).forEach(function(e){if(e.hasOwnProperty("cleaning")||(l=e[1],t=e[3],r=e[4],a=e[5],o=e[6],n=e[7],i=e[8],100==l||0==r))return;let u=Math.floor((milliSecondsFromString(n)-y)/1e3/3600/24)+1;milliSecondsFromString(o),d=(s=(c=document.querySelector("#rid_"+t)).firstElementChild).querySelector(".room-type").innerText,new Intl.DateTimeFormat("en",{month:"short",day:"2-digit"});let m="cst";if(0==d){if(c.classList.contains("already-cycled"))return;c.classList.add("already-cycled");let f="";0==u?9==i?(f="Left Today",m="cst-9"):(f="Will Leave Today",m="cst-8"):1==u?(f="Will leave tomorrow",m="cst-tomorrow"):5==i&&(f="In House",m="cst-8"),s.querySelector(".checkout-info").innerText=f,s.querySelector(".checkout-info").classList.add(m),s.querySelector(".room-card-left").classList.add(m)}else{let h=c.querySelector("#r"+t+"_b"+r),S="";0==u?9==i?(S="Left Today",m="cst-9"):(S="Will Leave Today",m="cst-8"):1==u&&(S="Will leave tomorrow",m="cst-tomorrow"),h.querySelector(".checkout-info").innerText=S,h.querySelector(".checkout-info").classList.add(m)}}),writeCleanInfos(cleanA,{})}function writeCleanInfos(e,t){e.forEach(function(e){let r=e[0],o=e[1],n=e[2];if(rtype=(card=(target=document.querySelector("#rid_"+r)).firstElementChild).querySelector(".room-type").innerText,card.dataset.clid=e[6],card.dataset.rid=r,0==rtype)0==n?(card.querySelector(".room-card-left").classList.add("cl-0"),card.querySelector(".room-clean-button.begin").classList.remove("disabled"),card.querySelector(".room-clean-button.finish").classList.remove("disabled"),card.querySelector(".toclean-info").classList.remove("hidden"),null!=e[3]&&(card.querySelector(".toclean-info-time").innerText=stringFromSeconds(e[3]))):1==n?(card.querySelector(".room-card-left").classList.add("cl-1"),card.querySelector(".room-clean-button.finish").classList.add("cleaning"),card.querySelector(".room-clean-button.finish").classList.remove("disabled"),card.querySelector(".cleaning-info").classList.remove("hidden"),null!=e[4]&&(card.querySelector(".cleaning-info-time").innerText=stringFromSeconds(e[4]))):5==n&&(card.querySelector(".cleaned-info").classList.remove("hidden"),null!=e[5]&&(card.querySelector(".cleaned-info-time").innerText=stringFromSeconds(e[5])),null!=e[5]&&(card.querySelector(".cleaned-info-user").innerText=e[8]));else{let l=target.querySelector("#r"+r+"_b"+o);0==n?(l.querySelector(".bed-clean-button.begin").classList.remove("disabled"),void 0!==t[r]?t[r]=t[r]+1:t[r]=1):1==n&&(l.querySelector(".bed-clean-button.begin").classList.add("hidden","disabled"),l.querySelector(".bed-clean-button.finish").classList.remove("hidden","disabled"))}}),console.log(t),Array.from(Object.keys(t)).forEach(function(e){let r=t[e],o="";o=1==r?"There is <span class='cleanBedsNumbers tcoral'>1</span> bed to clean":0==r?"There are no beds to clean":"There are <span class='cleanBedsNumbers tcoral'>"+r+"</span> beds to clean",(target=document.querySelector("#rid_"+e)).querySelector(".room-card-center .checkout-info").innerHTML=o,target.querySelector(".room-card-left").classList.add("cl-0")})}function drawSchema(){roomsDrawSchema()}function roomsDrawSchema(){let e;for(e=document.getElementById("room_view_container_privates");e.firstChild;)e.removeChild(e.firstChild);for(e=document.getElementById("room_view_container_shared");e.firstChild;)e.removeChild(e.firstChild);postHttpReq("rooms_schema_get")}function retrieveBookings(e){let t=new Date,r=new Date;r.setTime(t.getTime()-864e5),e=t.getFullYear()+"-"+String(parseInt(t.getMonth())+1).padStart(2,"0")+"-"+String(parseInt(t.getDate())).padStart(2,"0"),postHttpReq("rooms_retrieve_bookings",arr="&d="+(centerDateLess=r.getFullYear()+"-"+String(parseInt(r.getMonth())+1).padStart(2,"0")+"-"+String(parseInt(r.getDate())).padStart(2,"0"))+","+e)}function roomsShowAllBookings(e){let t=getParentByClass(e,"room-card-container"),r=t.id.split("_")[1];if(0==t.querySelector(".room-type").innerText)return!1;t.querySelector(".show-all-bookings").classList.toggle("hidden"),console.log(r)}function beginCleaningPrivate(e){if(e.classList.contains("disabled"))return;let t=getParentByClass(e,"room-card"),r=t.dataset.rid;e.classList.add("disabled"),e.parentElement.querySelector("a.finish").classList.add("cleaning"),t.querySelector(".room-card-left").classList.remove("cl-0"),t.querySelector(".room-card-left").classList.add("cl-1"),t.querySelector(".room-card-center .toclean-info").classList.add("hidden"),t.querySelector(".room-card-center .cleaning-info").classList.remove("hidden"),t.querySelector(".room-card-center .cleaning-info-time").innerText="0 minutes";let o=new FormData;o.append("state",1),o.append("rid",r),o.append("rtype",0),o.append("q","rooms_cln_update_private"),postFetch(o)}function finishCleaningPrivate(e){if(e.classList.contains("disabled"))return;let t=getParentByClass(e,"room-card"),r=t.dataset.rid;e.classList.add("disabled"),e.classList.remove("cleaning"),e.parentElement.querySelector("a.begin").classList.add("disabled"),t.querySelector(".room-card-left").classList.remove("cl-1","cl-0"),t.querySelector(".room-card-center .toclean-info").classList.add("hidden"),t.querySelector(".room-card-center .cleaning-info").classList.add("hidden"),t.querySelector(".room-card-center .cleaned-info").classList.remove("hidden"),t.querySelector(".room-card-center .cleaned-info-time").innerText="0 minutes";let o=new FormData;o.append("state",5),o.append("rid",r),o.append("rtype",0),o.append("q","rooms_cln_update_private"),postFetch(o)}function finishCleaningDorm(e){if(e.classList.contains("disabled"))return;let t=getParentByClass(e,"show-all-bookings-li"),r=t.dataset.rid,o=t.dataset.bed;e.classList.add("disabled");let n=new FormData;n.append("state",5),n.append("rid",r),n.append("bed",o),n.append("rtype",1),n.append("q","rooms_cln_update_dorm"),postFetch(n)}