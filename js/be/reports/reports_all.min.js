function reportSelector(e){let t=document.getElementById("reports_results_container"),r=t.querySelector("#reports_results"),l=document.querySelector("section.active form"),i=l.querySelector("input[name='current_page']"),s=l.querySelector("input[name='tot_pages']"),o=l.querySelector("input[name='csv']"),n=l.querySelector("input[name='method']").value,a=e.max_results,c=o.value;if(console.log(n),"reports_rooms"==n){callReportsRooms(e);return}if(t.classList.remove("hidden"),1==c){console.log(e.all_res_limited),Array.from(Object.keys(e.all_res_limited)).forEach(function(t){"reports_bookings"==n&&(e.all_res_limited[t].state=booking_states[e.all_res_limited[t].state]),"reports_customers"==n&&(e.all_res_limited[t].state=customer_states[e.all_res_limited[t].state],e.all_res_limited[t].title=customer_titles[e.all_res_limited[t].title],e.all_res_limited[t].idtype=id_types[e.all_res_limited[t].idtype])});downloadCSV(convertToCSV(e.all_res_limited)),o.value=0;return}Array.from(r.querySelectorAll(".result")).forEach(function(e){e.remove()}),Array.from(r.querySelectorAll(".header")).forEach(function(e){e.classList.add("hidden")}),r.querySelector("."+n).classList.remove("hidden");let d=e.count[0].count;t.querySelectorAll(".total_results").forEach(function(e){e.innerText=d});let u=i.value,f=Math.ceil(d/a);if(s.value=f,t.querySelector(".page_infos").innerText=u+" of "+f,"reports_bookings"==n)callReportsBookings(e.all_res_limited,r);else if("reports_customers"==n)callReportsCustomers(e.all_res_limited,r);else if("reports_payments"==n){let m=e.count[0].total;callReportsPayments(e.all_res_limited,m,r)}else if("reports_expenses"==n){let v=e.count[0].total;callReportsExpenses(e.all_res_limited,v,r)}}function callReportsBookings(e,t){let r="";Object.values(e).forEach(function(e){Array.from(Object.keys(e)).forEach(function(t){null==e[t]&&(e[t]="---")});let t=e.state;r+="	<li class='grid-container mb1 result' style='grid-template-columns: 2fr 1fr 2fr 2fr 2fr 2fr 2fr 2fr 2fr 2fr 2fr 1fr'>",r+="		<div>"+e.name+"</div>",r+="		<div>"+e.pax+"</div>",r+="		<div class='small'>"+e.insert_date+"</div>",r+="		<div>"+e.arrival_date+"</div>",r+="		<div>"+e.leave_date+"</div>",r+="		<div>"+e.checkin+"</div>",r+="		<div>"+e.checkout+"</div>",r+="		<div class='st-"+t+"'>"+booking_states[t]+"</div>",r+="		<div>"+e.channel+"</div>",r+="		<div>"+e.rnames.replace(/,/g,"<br>")+"</div>",r+="		<div class='bold p0'>"+e.balance+"</div>",r+="		<div class='flex-centered'>",r+="			<a href='/workspace/booking.php?bid="+e.bid+"'>",r+="				<img src='/assets/be/icons/user-solid.svg' class='filter-green pointer' width='16' height='16')>",r+="			</a>",r+="		</div>",r+="	</li>"}),t.innerHTML+=r}function callReportsCustomers(e,t){let r="";Object.values(e).forEach(function(e){Array.from(Object.keys(e)).forEach(function(t){null==e[t]&&(e[t]="")}),console.log(e);let t=e.state;0==t.length&&(states=0);let l=e.idtype;0==l.length&&(l=0);let i=e.title;0==i.length&&(i=0),r+="	<li class='grid-container mb1 result' style='grid-template-columns: 1fr 2fr 2fr 1fr 2fr 2fr 1fr 2fr 2fr 2fr 1fr 1fr'>",r+="		<div>"+customer_titles[i]+"</div>",r+="		<div>"+e.name+"</div>",r+="		<div>"+e.email+"</div>",r+="		<div>"+id_types[l]+"</div>",r+="		<div>"+e.idnum+"</div>",r+="		<div class='flex-centered'>",r+="			<span>"+e.street+"</span>",r+="			<span>"+e.city+" - "+e.cp+"</span>",r+="		</div>",r+="		<div>"+e.country+"</div>",r+="		<div>"+e.last_checkin+"</div>",r+="		<div>"+e.last_checkout+"</div>",r+="		<div>"+customer_states[t]+"</div>",r+="		<div>"+e.visits+"</div>",r+="		<div class='flex-centered'>",r+="			<a href='/workspace/customers.php?cid="+e.cid+"'>",r+="				<img src='/assets/be/icons/user-solid.svg' class='filter-green pointer' width='16' height='16')>",r+="			</a>",r+="		</div>",r+="	</li>"}),t.innerHTML+=r}function callReportsPayments(e,t,r){let l="";Object.values(e).forEach(function(e){Array.from(Object.keys(e)).forEach(function(t){null==e[t]&&(e[t]="")}),l+="	<li class='grid-container mb1 result' style='grid-template-columns: 2fr 2fr 1fr 3fr 2fr 1fr'>",l+="		<div class='small'>"+e.insert_date+"</div>",l+="		<div>"+e.name+"</div>",l+="		<div>"+e.service+"</div>",l+="		<div>"+e.note+"</div>",l+="		<div class='bold'>"+e.amount+"</div>",l+="		<div class='flex-centered'>",l+="			<a href='/workspace/booking.php?bid="+e.bid+"'>",l+="				<img src='/assets/be/icons/user-solid.svg' class='filter-green pointer' width='16' height='16')>",l+="			</a>",l+="		</div>",l+="	</li>"}),l+="	<li class='grid-container mb1 result' style='grid-template-columns: 8fr 2fr 1fr'>",l+="		<h4 class='ta-c'>Total Amount in query</h4>",l+="		<h2 class='m1'><span class='tred m1'>"+t+"</span></h2>",l+="		<span></span>",l+="	</li>",r.innerHTML+=l}function callReportsExpenses(e,t,r){let l="";Object.values(e).forEach(function(e){Array.from(Object.keys(e)).forEach(function(t){null==e[t]&&(e[t]="")}),l+="	<li class='grid-container mb1 result' style='grid-template-columns: 1fr 1fr 5fr 1fr 1fr'>",l+="		<div class='small'>"+e.insert_date+"</div>",l+="		<div>"+e.uname+"</div>",l+="		<div>"+e.descr+"</div>",l+="		<div class='bold'>"+e.amount+"</div>",l+="		<div class='flex-centered'>",l+="			<a href='#_' onClick='expenseDelete("+e.id+")'>",l+="				<img src='/assets/be/icons/times-solid.svg' class='filter-red pointer' width='16' height='16')>",l+="			</a>",l+="		</div>",l+="	</li>"}),l+="	<li class='grid-container mb1 result' style='grid-template-columns: 8fr 2fr'>",l+="		<h4 class='ta-c'>Total Amount in query</h4>",l+="		<h2 class='m1'><span class='tred m1'>"+t+"</span></h2>",l+="	</li>",r.innerHTML+=l}function callReportsRooms(e){document.querySelector("#reports_rooms_container").classList.remove("hidden");let t=document.querySelector("#reports_rooms_privates_results"),r=document.querySelector("#reports_rooms_shared_results");Array.from(t.querySelectorAll(".result")).forEach(function(e){e.remove()}),Array.from(r.querySelectorAll(".result")).forEach(function(e){e.remove()});let l=document.getElementById("room_sd").value.split("-");document.getElementById("room_ed").value.split("-"),console.log(l);let i=str_priv=str_dorm="",s=pay_dorm=0;Object.values(e).forEach(function(e){Array.from(Object.keys(e)).forEach(function(t){null==e[t]&&("pays"==t?e[t]=0:e[t]="")}),console.log(e);let l=e.type,o=e.pays;i="	<li class='grid-container mb1 result' style='grid-template-columns: 2fr 1fr 1fr 1fr'>",i+="		<div>"+e.name+"</div>",i+="		<div>"+e.bids+"</div>",i+="		<div>"+e.customers+"</div>",i+="		<div class='bold'>"+o+"</div>";let n=parseHTML(i+="	</li>");0==l?(s+=parseInt(o),t.appendChild(n)):(pay_dorm+=parseInt(o),r.appendChild(n))})}function toggleOption(e){let t=e.checked;t?e.value=1:e.value=0,console.log(t)}function nextPage(){let e=document.querySelector("section.active form"),t=e.querySelector("input[name='current_page']"),r=e.querySelector("input[name='tot_pages']").value,l=parseInt(t.value)+1;if(l>r)return;t.value=l;let i=e.querySelector("input[name='method']").value;formSubmitXML(e.querySelector("button.submit"),i)}function prevPage(){let e=document.querySelector("section.active form"),t=e.querySelector("input[name='current_page']"),r=parseInt(t.value)-1;if(r<1)return;t.value=r;let l=e.querySelector("input[name='method']").value;formSubmitXML(e.querySelector("button.submit"),l)}function showReportFilter(e,t){document.querySelectorAll(".reports-menu-item").forEach(function(e){e.classList.remove("active")}),t.classList.add("active");let r=document.getElementById(e);document.querySelectorAll("section.report-filter").forEach(function(e){e.classList.add("hidden"),e.classList.remove("active")}),cleanResults(),r.classList.remove("hidden"),r.classList.add("active")}function cleanResults(){let e=document.getElementById("reports_results_container");e.classList.add("hidden");let t=document.getElementById("reports_rooms_container");t.classList.add("hidden");Array.from(e.querySelector("#reports_results").querySelectorAll(".result")).forEach(function(e){e.remove()}),Array.from(t.querySelectorAll("ul .result")).forEach(function(e){e.remove()})}function reportCleanForm(e){e.querySelector("input[name='current_page']").value=1,e.querySelector("input[name='tot_pages']").value=0,e.querySelector("input[name='csv']").value=0}function reportFilterClick(e){reportCleanForm(e.form);let t=e.form.querySelector("input[name='method']").value;formSubmitXML(e,t)}function reportsCSV(){let e=document.querySelector("section.active form");e.querySelector("input[name='csv']").value=1;let t=e.querySelector("input[name='method']").value;formSubmitXML(e.querySelector("button.submit"),t)}function convertToCSV(e){let t=[Object.keys(e[0])].concat(e);return t.map(function(e){return Object.values(e).map(function(e){return JSON.stringify(e).replace(/[^0-9a-zA-Z_", \-:;]/g,"")}).join(",")}).join("\n")}function downloadCSV(e){let t=document.createElement("a"),r=new Date,l=document.querySelector("section.active form").querySelector("input[name='method']").value;r=r.toISOString().replace(/[^0-9]+/g,"").substring(0,12),t.href="data:attachment/text,"+encodeURI(e),t.target="_blank",t.download=r+"_"+l+"_export.csv";let i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),t.dispatchEvent(i)}function expenseDelete(e){let t=new FormData;t.append("q","calendar_expense_delete"),t.append("id",e),postFetch(t)}